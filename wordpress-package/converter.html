<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordPress HTML変換ツール</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; background: #f5f5f5; }
        .box { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #EC4899; }
        input[type="file"] { display: block; margin: 10px 0; padding: 10px; width: 100%; }
        input[type="text"] { width: 100%; padding: 10px; margin: 10px 0; }
        button { background: #EC4899; color: white; border: none; padding: 15px 30px; font-size: 16px; border-radius: 5px; cursor: pointer; width: 100%; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        button:hover:not(:disabled) { background: #DB2777; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; display: none; }
        .success { display: block; background: #d1fae5; color: #065f46; }
        #output { display: none; margin-top: 20px; }
        #output.show { display: block; }
        textarea { width: 100%; height: 300px; font-family: monospace; padding: 10px; }
    </style>
</head>
<body>
    <h1>WordPress HTML変換ツール</h1>
    
    <div class="box">
        <h3>STEP 1: HTMLファイル選択</h3>
        <input type="file" id="html" accept=".html">
        <div class="status" id="htmlStatus"></div>
    </div>

    <div class="box">
        <h3>STEP 2: CSSファイル選択</h3>
        <input type="file" id="css" accept=".css">
        <div class="status" id="cssStatus"></div>
    </div>

    <div class="box">
        <h3>STEP 3: JavaScriptファイル選択</h3>
        <input type="file" id="js" accept=".js">
        <div class="status" id="jsStatus"></div>
    </div>

    <div class="box">
        <h3>STEP 4: 子テーマ名</h3>
        <input type="text" id="theme" value="advance-child-theme">
    </div>

    <div class="box">
        <button id="convert" disabled>変換を実行</button>
    </div>

    <div id="output" class="box">
        <h3>変換完了</h3>
        <textarea id="result" readonly></textarea>
        <button id="download">ダウンロード</button>
    </div>

    <script>
var h=null,c=null,j=null,fn='';
document.getElementById('html').onchange=function(e){
var f=e.target.files[0];if(!f)return;fn=f.name;
var r=new FileReader();r.onload=function(x){h=x.target.result;
document.getElementById('htmlStatus').className='status success';
document.getElementById('htmlStatus').textContent='読込完了: '+f.name;
if(h&&c&&j)document.getElementById('convert').disabled=false;};
r.readAsText(f);};
document.getElementById('css').onchange=function(e){
var f=e.target.files[0];if(!f)return;
var r=new FileReader();r.onload=function(x){c=x.target.result;
document.getElementById('cssStatus').className='status success';
document.getElementById('cssStatus').textContent='読込完了: '+f.name;
if(h&&c&&j)document.getElementById('convert').disabled=false;};
r.readAsText(f);};
document.getElementById('js').onchange=function(e){
var f=e.target.files[0];if(!f)return;
var r=new FileReader();r.onload=function(x){j=x.target.result;
document.getElementById('jsStatus').className='status success';
document.getElementById('jsStatus').textContent='読込完了: '+f.name;
if(h&&c&&j)document.getElementById('convert').disabled=false;};
r.readAsText(f);};
document.getElementById('convert').onclick=function(){
var t=document.getElementById('theme').value||'advance-child-theme';
var o=h;
o=o.replace(/<link[^>]*stylesheet[^>]*>/gi,'');
o=o.replace('</head>','\n<style>\n'+c+'\n</style>\n</head>');
o=o.replace(/<script[^>]*src=[^>]*><\/script>/gi,'');
o=o.replace('</body>','\n<script>\n'+j+'\n<\/script>\n</body>');
var p='/wp-content/themes/'+t+'/images/';
o=o.replace(/src="images\//g,'src="'+p);
o=o.replace(/src='images\//g,"src='"+p);
o=o.replace(/url\(images\//g,'url('+p);
o=o.replace(/url\('images\//g,"url('"+p);
o=o.replace(/url\("images\//g,'url("'+p);
o=o.replace(/href="index\.html"/g,'href="/"');
o=o.replace(/href='index\.html'/g,"href='/'");
o=o.replace(/href="([^":#]+)\.html"/g,'href="/$1/"');
o=o.replace(/href='([^':#]+)\.html'/g,"href='/$1/'");
document.getElementById('result').value=o;
document.getElementById('output').className='box show';
document.getElementById('output').scrollIntoView({behavior:'smooth'});
};
document.getElementById('download').onclick=function(){
var o=document.getElementById('result').value;
var n=fn.replace('.html','')+'-converted.html';
var b=new Blob([o],{type:'text/html'});
var u=URL.createObjectURL(b);
var a=document.createElement('a');
a.href=u;a.download=n;a.click();
URL.revokeObjectURL(u);
};
    </script>
</body>
</html>
